# 마할라노비스 거리

**마할라노비스 거리**(Mahalanobis Distance)는 두 점 간의 거리를 측정할 때 데이터의 분포를 고려한 거리 계산 방법입니다. 이는 특히 다변량 데이터의 분석에 유용하며, 데이터의 분포 및 상관관계를 반영하여 거리를 측정할 수 있습니다.

## 1. 정의

마할라노비스 거리는 다음과 같이 정의됩니다:

$$
D_M(\mathbf{x}) = \sqrt{(\mathbf{x} - \mu)^\top \Sigma^{-1} (\mathbf{x} - \mu)}
$$

여기서:
- $\mathbf{x}$는 n차원의 데이터 벡터입니다.
- $\mu$는 데이터의 평균 벡터입니다.
- $\Sigma$는 데이터의 공분산 행렬입니다.
- $\Sigma^{-1}$은 공분산 행렬의 역행렬입니다.

마할라노비스 거리는 단순히 두 점 간의 유클리드 거리와는 달리, 데이터의 스케일 및 상관관계를 고려한 거리 측정이 가능하다는 점에서 유용합니다.

## 2. 특성

### 2.1 공분산을 고려한 거리
마할라노비스 거리는 데이터의 공분산 구조를 반영하므로, 데이터가 퍼져 있는 방향에 따라 거리가 다르게 측정됩니다. 이는 고차원 공간에서 데이터의 분포가 비정규적인 경우 특히 유용합니다.

### 2.2 차원 단위의 비의존성
각 데이터 차원의 스케일이 다르더라도 마할라노비스 거리는 이를 자동으로 보정합니다. 예를 들어, 어떤 차원이 다른 차원에 비해 더 큰 스케일을 가지는 경우에도 마할라노비스 거리는 이를 고려하여 거리를 계산합니다.

### 2.3 표준화된 거리
마할라노비스 거리는 동일한 분포 내에서의 거리를 표준화하여, 서로 다른 분포 간의 비교를 가능하게 합니다. 예를 들어, 서로 다른 두 군집 간의 중심에서 각 점까지의 거리를 마할라노비스 거리를 이용해 비교할 수 있습니다.

## 3. 응용

### 3.1 이상치 탐지
마할라노비스 거리는 다변량 데이터에서 이상치를 탐지하는 데 자주 사용됩니다. 평균으로부터의 마할라노비스 거리가 특정 임계값을 넘는 데이터 포인트는 이상치로 간주할 수 있습니다.

### 3.2 군집 분석
마할라노비스 거리는 군집 분석에서 각 군집의 중심과 데이터 포인트 간의 거리를 측정하는 데 사용될 수 있습니다. 이는 특히 가우시안 혼합 모델(Gaussian Mixture Model, GMM)에서 군집화 성능을 향상시키는 데 기여합니다.

### 3.3 분류 문제
마할라노비스 거리는 베이즈 분류기에서 클래스 간의 유사성을 측정하는 데 사용됩니다. 클래스 간의 분산이 클 때 유클리드 거리 대신 마할라노비스 거리를 사용하면 분류 성능이 향상될 수 있습니다.

## 4. 유클리드 거리와의 비교

유클리드 거리는 다음과 같이 정의됩니다:

$$
D_E(\mathbf{x}, \mathbf{y}) = \sqrt{(\mathbf{x} - \mathbf{y})^\top (\mathbf{x} - \mathbf{y})}
$$

유클리드 거리와 비교했을 때, 마할라노비스 거리는 공분산 행렬을 고려하여 데이터의 구조를 반영한 거리를 계산하므로, 동일한 차원에서 각 데이터 포인트의 상대적인 위치를 보다 정확히 반영할 수 있습니다.

## 참고 문헌
- Bishop, C. M. (2006). *Pattern Recognition and Machine Learning*. Springer.
- Murphy, K. P. (2022). *Probabilistic Machine Learning: An Introduction*. MIT Press.
- Murphy, K. P. (2023). *Probabilistic Machine Learning: Advanced Topics*. MIT Press.
