# 신뢰 영역법 (Trust Region Method)

**신뢰 영역법**(Trust Region Method)은 최적화 문제를 해결하기 위한 방법 중 하나로, 목적 함수의 지역적 근사를 사용하는 대신, 해의 신뢰성을 보장하기 위해 특정 영역 내에서만 근사를 적용하는 방식입니다. 이 방법은 크게 비선형 최적화 문제에서 효과적이며, 특히 뉴턴법과 같은 전통적인 방법이 불안정할 수 있는 경우에도 안정적인 해를 제공합니다.

## 1. 기본 개념

신뢰 영역법은 현재 추정된 해에서 목적 함수를 근사하는 **모델 함수**(quadratic model function)를 정의하고, 이 모델 함수가 적절하게 근사할 수 있는 범위를 **신뢰 영역**(trust region)으로 설정하여 최적화를 진행합니다.

모델 함수는 일반적으로 2차 근사를 사용하여 다음과 같이 표현됩니다:

$$
m_k(p) = f(\theta_k) + \nabla f(\theta_k)^\top p + \frac{1}{2} p^\top B_k p
$$

여기서:
- $m_k(p)$는 $k$번째 반복에서의 모델 함수입니다.
- $f(\theta_k)$는 $k$번째 반복에서의 목적 함수 값입니다.
- $\nabla f(\theta_k)$는 $k$번째 반복에서의 목적 함수의 기울기입니다.
- $B_k$는 헤세 행렬(Hessian matrix)의 근사치입니다.
- $p$는 신뢰 영역 내에서의 탐색 방향입니다.

## 2. 신뢰 영역의 설정

신뢰 영역법에서는 모델 함수가 유효하다고 믿는 **신뢰 영역**의 크기, 즉 반경 $\Delta_k$를 설정합니다. 탐색 방향 $p_k$는 이 신뢰 영역 내에서 선택됩니다:

$$
\|p_k\| \leq \Delta_k
$$

이때, $\Delta_k$는 다음과 같은 기준에 따라 조정됩니다:
- 모델 함수 $m_k(p)$가 목적 함수 $f(\theta_k)$를 잘 근사하면, $\Delta_k$를 크게 설정하여 더 큰 영역에서 탐색을 시도합니다.
- 반대로, 근사가 적절하지 않다면, $\Delta_k$를 줄여 더 작은 영역에서 탐색을 진행합니다.

## 3. 알고리즘 절차

신뢰 영역법의 기본 절차는 다음과 같습니다:

1. **초기화**: 초기 해 $\theta_0$와 신뢰 영역의 초기 반경 $\Delta_0$을 설정합니다.
2. **모델 함수 설정**: 현재 해 $\theta_k$에서의 목적 함수를 2차 근사하여 모델 함수 $m_k(p)$를 설정합니다.
3. **탐색 방향 결정**: 신뢰 영역 $\|p_k\| \leq \Delta_k$ 내에서 모델 함수를 최소화하는 방향 $p_k$를 구합니다.
4. **신뢰 영역 조정**: $f(\theta_k)$와 $m_k(p_k)$의 값을 비교하여, 신뢰 영역 반경 $\Delta_k$를 조정합니다.
   - 근사가 잘 되었다면, $\Delta_k$를 증가시켜 다음 반복에서 더 큰 영역을 탐색합니다.
   - 근사가 잘 되지 않았다면, $\Delta_k$를 줄여 다음 반복에서 더 작은 영역을 탐색합니다.
5. **수렴 검사**: 수렴 조건을 만족하면 알고리즘을 종료하고, 그렇지 않으면 2단계로 돌아가 반복합니다.

## 4. 신뢰 영역법의 장점과 단점

### 4.1 장점

- **안정성**: 모델 함수가 잘 근사할 수 있는 영역 내에서만 탐색을 진행하므로, 최적화 과정의 안정성이 높습니다.
- **효율성**: 신뢰 영역의 크기를 조정함으로써, 최적화의 수렴 속도와 효율성을 높일 수 있습니다.

### 4.2 단점

- **복잡성**: 신뢰 영역의 설정과 조정이 추가적인 계산을 요구하므로, 구현이 복잡할 수 있습니다.
- **매개변수 조정**: 신뢰 영역 반경의 초기 값과 조정 기준이 성능에 큰 영향을 미칠 수 있습니다.

## 5. 결론

신뢰 영역법은 신뢰 영역 내에서 모델 함수를 근사하여 최적화 문제를 해결하는 방법입니다. 이 방법은 특히 목적 함수가 복잡하거나, 전통적인 방법이 불안정하게 동작할 수 있는 경우에 유용합니다. 신뢰 영역의 조정을 통해 안정적이면서도 효율적인 최적화를 달성할 수 있습니다.

## 참고 문헌

- Bishop, C. M. (2006). *Pattern Recognition and Machine Learning*. Springer.
- Murphy, K. P. (2022). *Probabilistic Machine Learning: An Introduction*. MIT Press.
- Murphy, K. P. (2023). *Probabilistic Machine Learning: Advanced Topics*. MIT Press.
