# 베타-이항 모델 (Beta-Binomial Model)

**베타-이항 모델**은 베이즈 추론에서 자주 사용되는 확률 모델로, 이항 분포와 베타 분포의 결합을 통해 이항 실험에서 성공 확률에 대한 불확실성을 모델링할 수 있습니다. 이 모델은 주로 불확실한 성공 확률을 가진 이항 실험에 적합합니다.

## 1. 이항 분포와 베타 분포

베타-이항 모델을 이해하기 위해 먼저 **이항 분포**와 **베타 분포**를 알아야 합니다.

- **이항 분포**는 일정한 성공 확률 $p$에 따라 $n$번의 독립적인 시도를 통해 $k$번의 성공이 발생할 확률을 나타냅니다. 그 확률 질량 함수(PMF)는 다음과 같습니다:

  $$
  P(X = k \mid n, p) = \binom{n}{k} p^k (1 - p)^{n - k}
  $$

  여기서 $\binom{n}{k}$는 이항 계수입니다.

- **베타 분포**는 [0, 1] 구간에 정의된 연속 확률 분포로, 성공 확률 $p$의 사전 분포로 자주 사용됩니다. 베타 분포는 두 모수 $\alpha$와 $\beta$로 정의되며, 그 확률 밀도 함수(PDF)는 다음과 같습니다:

  $$
  P(p \mid \alpha, \beta) = \frac{p^{\alpha - 1} (1 - p)^{\beta - 1}}{B(\alpha, \beta)}
  $$

  여기서 $B(\alpha, \beta)$는 베타 함수입니다.

## 2. 베타-이항 모델의 정의

베타-이항 모델은 베타 분포를 사전 분포로 사용하여 이항 실험의 성공 확률 $p$에 대한 불확실성을 반영합니다. 이 모델에서 성공 확률 $p$는 베타 분포를 따르며, $p$가 주어졌을 때 성공의 횟수 $k$는 이항 분포를 따릅니다.

베타-이항 모델의 결합 확률은 다음과 같습니다:

$$
P(k \mid n, \alpha, \beta) = \int_0^1 P(k \mid n, p) P(p \mid \alpha, \beta) \, dp
$$

이 결과는 다음과 같은 형태로 정리될 수 있습니다:

$$
P(k \mid n, \alpha, \beta) = \binom{n}{k} \frac{B(\alpha + k, \beta + n - k)}{B(\alpha, \beta)}
$$

이 식에서 $B(\cdot, \cdot)$는 베타 함수입니다.

## 3. 베타-이항 모델의 적용

베타-이항 모델은 관측 데이터가 적을 때, 즉 샘플 크기가 작을 때 유용하게 사용할 수 있습니다. 이 모델은 이항 분포의 성공 확률에 대한 불확실성을 반영하여 과대적합(overfitting)을 방지할 수 있습니다.

예를 들어, 10번의 동전 던지기에서 7번이 앞면이 나왔다고 가정해 봅시다. 이항 분포만 사용한다면 성공 확률 $p$를 0.7로 추정할 수 있지만, 베타-이항 모델을 사용하면 베타 분포를 통해 이 확률이 더 넓은 범위에 걸쳐 있을 수 있음을 반영할 수 있습니다.

## 4. 사후 분포

베이즈 정리에 따라, 사후 분포는 사전 분포와 우도 함수의 곱으로 계산됩니다. 베타-이항 모델에서 사후 분포는 다음과 같이 표현됩니다:

$$
P(\theta \mid k, n, \alpha, \beta) \propto P(k \mid \theta, n) P(\theta \mid \alpha, \beta)
$$

이 식을 통해 얻어진 사후 분포는 베타 분포의 형태를 유지하며, 갱신된 모수 $\alpha'$와 $\beta'$를 갖습니다:

$$
\alpha' = \alpha + k
$$

$$
\beta' = \beta + n - k
$$

따라서, 갱신된 사후 분포는 다음과 같습니다:

$$
P(\theta \mid k, n, \alpha, \beta) = \text{Beta}(\theta; \alpha + k, \beta + n - k)
$$

이 결과는 베타 분포의 사후 분포가 여전히 베타 분포임을 보여주는 중요한 성질입니다. 이 성질을 **켤레 사전 분포**(Conjugate Prior)라고 부릅니다.

## 5. 예시

만약 우리가 사전 지식으로 $\alpha = 2$, $\beta = 3$인 베타 분포를 가지고 있고, 10번의 실험에서 7번 성공했다고 합시다. 그렇다면 사후 분포는 다음과 같이 계산됩니다:

$$
\alpha' = 2 + 7 = 9
$$

$$
\beta' = 3 + 10 - 7 = 6
$$

따라서, 갱신된 사후 분포는 $\text{Beta}(\theta; 9, 6)$이 됩니다.