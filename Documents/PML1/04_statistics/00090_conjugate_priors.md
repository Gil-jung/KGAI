# 켤레 사전 분포 (Conjugate Prior Distribution)

**켤레 사전 분포**는 베이즈 추론에서 매우 중요한 개념입니다. 특정 형태의 사전 분포와 우도 함수가 결합될 때, 그 결과인 사후 분포가 동일한 함수족에 속하게 되는 경우, 이러한 사전 분포를 **켤레 사전 분포**라고 부릅니다.

## 1. 켤레 사전 분포의 정의

베이즈 정리에 따르면, 사후 확률은 사전 확률과 우도 함수의 곱으로 표현됩니다. 즉,

$$
P(\theta \mid D) \propto P(D \mid \theta) P(\theta)
$$

여기서 $\theta$는 모수(parameter), $D$는 관측된 데이터입니다. 

켤레 사전 분포는 특정 형태의 우도 함수에 대해 사전 확률을 선택함으로써, 사후 확률 역시 동일한 함수족의 형태를 유지하도록 합니다. 예를 들어, 베르누이 분포의 우도 함수에 대해 베타 분포를 사전 확률로 선택하면, 사후 확률도 베타 분포의 형태를 유지합니다. 

## 2. 켤레 사전 분포의 이점

켤레 사전 분포를 사용하는 주요 이점은 다음과 같습니다:

- **계산의 간편성**: 사후 분포의 계산이 간단해집니다. 이는 특히 복잡한 모델에서 사후 분포를 구하는 데 드는 계산 비용을 줄여줍니다.
- **분석적 해의 존재**: 켤레 사전 분포를 사용하면, 수치적 방법 없이도 사후 분포를 분석적으로 구할 수 있습니다.
- **직관적 해석 가능**: 동일한 함수족 내에서 사후 분포를 유지하기 때문에, 사전과 사후의 비교가 직관적으로 가능합니다.

## 3. 예시: 베르누이 분포와 베타 분포

베르누이 분포에서의 성공 확률 $\theta$에 대한 사전 분포로 베타 분포를 사용하면, 관측 데이터 $D$에 따른 사후 분포도 베타 분포가 됩니다. 이를 수식으로 표현하면:

- 우도 함수가 베르누이 분포일 때:
  
  $$
  P(D \mid \theta) = \theta^k (1 - \theta)^{n-k}
  $$

  여기서 $k$는 성공의 수, $n$은 전체 실험 수입니다.

- 사전 분포가 베타 분포일 때:

  $$
  P(\theta) = \text{Beta}(\theta \mid \alpha, \beta) = \frac{\theta^{\alpha - 1} (1 - \theta)^{\beta - 1}}{B(\alpha, \beta)}
  $$

  여기서 $B(\alpha, \beta)$는 베타 함수입니다.

- 사후 분포는 다시 베타 분포가 됩니다:

  $$
  P(\theta \mid D) = \text{Beta}(\theta \mid \alpha + k, \beta + n - k)
  $$

## 4. 켤레 사전 분포의 일반화

켤레 사전 분포는 다양한 분포에 대해 정의될 수 있습니다. 예를 들어, 정규 분포의 우도 함수에 대한 켤레 사전 분포는 정규-위치-스케일 분포입니다.

## 5. 켤레 사전 분포의 한계

켤레 사전 분포의 주요 한계는 유연성의 부족입니다. 현실의 문제에서는 사전 지식이 특정 분포에 부합하지 않을 수 있습니다. 이 경우 켤레 사전 분포를 고수하기보다는, 더 복잡한 또는 비켤레 사전 분포를 고려하는 것이 적합할 수 있습니다.

## 6. 참고 문헌

- Bishop, C. M. (2006). *Pattern Recognition and Machine Learning*. Springer.
- Murphy, K. P. (2022). *Probabilistic Machine Learning: An Introduction*. MIT Press.
- Murphy, K. P. (2023). *Probabilistic Machine Learning: Advanced Topics*. MIT Press.
