# 온라인 (재귀) 추정

온라인 추정(Online Estimation) 또는 재귀 추정(Recursive Estimation)은 데이터가 순차적으로 들어오는 상황에서 모수나 상태를 실시간으로 추정하는 방법입니다. 이는 데이터가 한 번에 모두 제공되지 않고, 시간에 따라 점진적으로 수집되는 상황에 특히 유용합니다. 이 방법은 일반적으로 머신러닝, 신호 처리, 제어 시스템 등에서 많이 사용됩니다.

## 1. 온라인 추정의 개념

온라인 추정은 데이터가 도착할 때마다 모수를 갱신하는 방법입니다. 이는 모든 데이터가 한 번에 제공되는 배치(batch) 학습과 달리, 데이터 포인트가 순차적으로 도착하는 상황에서 효과적입니다. 온라인 추정의 주요 목표는 데이터가 들어올 때마다 모수를 점진적으로 업데이트하여 모델의 추정값을 향상시키는 것입니다.

## 2. 재귀 추정의 수식

재귀 추정에서는 이전 상태의 추정값을 기반으로 새 데이터를 통합하여 모수를 갱신합니다. 예를 들어, 선형 모델에서 재귀 최소자승법(Recursive Least Squares, RLS)을 사용하는 경우, 갱신 식은 다음과 같이 표현됩니다:

$$
\hat{\theta}_{t+1} = \hat{\theta}_t + K_t (y_{t+1} - \phi_{t+1}^T \hat{\theta}_t)
$$

여기서:
- $\hat{\theta}_{t+1}$: 시간 $t+1$에서의 모수 추정값
- $\hat{\theta}_t$: 시간 $t$에서의 모수 추정값
- $K_t$: 이득(gain) 벡터, 이는 업데이트 방향을 결정합니다.
- $y_{t+1}$: 시간 $t+1$에서의 실제 관측값
- $\phi_{t+1}$: 시간 $t+1$에서의 피처 벡터

이 식은 새로운 데이터가 도착할 때마다 모델의 추정값을 갱신하는 방식으로 작동합니다.

## 3. 칼만 필터와 재귀 추정

칼만 필터(Kalman Filter)는 재귀 추정의 대표적인 예로, 선형 동적 시스템의 상태를 추정하는 데 사용됩니다. 이 필터는 현재 상태 추정값과 관측값을 결합하여 상태를 업데이트합니다. 칼만 필터의 주요 식은 다음과 같습니다:

$$
\hat{x}_{t|t} = \hat{x}_{t|t-1} + K_t (z_t - H_t \hat{x}_{t|t-1})
$$

여기서:
- $\hat{x}_{t|t}$: 시간 $t$에서의 상태 추정값
- $\hat{x}_{t|t-1}$: 시간 $t-1$에서의 상태 추정값을 기반으로 한 시간 $t$에서의 예측값
- $K_t$: 칼만 이득(Kalman gain)
- $z_t$: 시간 $t$에서의 관측값
- $H_t$: 관측 모델

이 식은 관측값 $z_t$와 예측값 $\hat{x}_{t|t-1}$의 차이를 사용하여 상태 추정값을 갱신합니다.

## 4. 온라인 추정의 장점

- **효율성**: 데이터가 순차적으로 들어올 때마다 모수를 갱신하므로, 전체 데이터를 다시 처리할 필요 없이 빠르게 업데이트할 수 있습니다.
- **실시간 처리**: 데이터가 실시간으로 제공되는 상황에서 유용합니다.
- **메모리 절약**: 모든 데이터를 저장할 필요 없이, 현재 상태만을 유지하며 처리할 수 있습니다.

## 5. 온라인 추정의 단점

- **수렴 문제**: 순차적인 업데이트로 인해 수렴 속도가 느리거나, 데이터의 노이즈에 민감하여 수렴이 불안정할 수 있습니다.
- **복잡성**: 특히 비선형 시스템에서는 재귀 추정이 복잡해질 수 있습니다.

## 6. 결론

온라인 (재귀) 추정은 실시간으로 데이터를 처리하고 모수를 추정하는 데 매우 유용한 방법입니다. 이는 실시간 시스템, 적응형 필터링, 머신러닝 모델의 실시간 추정에 특히 유용합니다. 그러나 데이터의 노이즈에 민감하거나 비선형 시스템에서는 수렴 문제가 발생할 수 있습니다.
