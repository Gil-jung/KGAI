# 가우스 판별분석 모델 적합시키기

가우스 판별분석(Gaussian Discriminant Analysis, GDA)은 지도 학습(supervised learning) 알고리즘 중 하나로, 클래스별로 데이터가 가우시안(정규) 분포를 따른다는 가정 하에 분류 문제를 해결합니다. GDA는 특히 데이터가 다변량 정규 분포를 따른다고 가정할 때 효과적으로 작동하며, 베이즈 정리를 기반으로 한 확률적 해석을 제공합니다. 이 문서에서는 GDA 모델을 적합시키는 과정에 대해 자세히 설명하고, 수학적 배경과 함께 실제 구현 방법을 다룹니다.

## 목차

1. [가우스 판별분석의 개요](#가우스-판별분석의-개요)
2. [모델 가정](#모델-가정)
3. [GDA 모델 적합 과정](#gda-모델-적합-과정)
   - [파라미터 추정](#파라미터-추정)
   - [사후 확률 계산](#사후-확률-계산)
4. [의사결정 경계 설정](#의사결정-경계-설정)
5. [모델 평가](#모델-평가)
6. [장단점](#장단점)
7. [응용 사례](#응용-사례)
8. [참고문헌](#참고문헌)

## 가우스 판별분석의 개요

가우스 판별분석은 각 클래스의 조건부 확률을 다변량 정규 분포로 모델링하여, 입력 데이터가 어느 클래스에 속할 확률이 높은지를 계산하여 분류를 수행합니다. 이는 클래스 간의 분포 차이를 기반으로 한 확률적 분류 방식으로, 데이터의 통계적 특성을 반영한 해석이 가능합니다.

## 모델 가정

GDA는 다음과 같은 가정을 기반으로 합니다:

1. **클래스별 정규 분포**: 각 클래스 \( y = k \)는 평균 벡터 \( \mu_k \)와 공분산 행렬 \( \Sigma_k \)을 가지는 다변량 정규 분포를 따른다.
2. **클래스 사전 확률**: 각 클래스 \( y = k \)의 사전 확률 \( p(y = k) \)은 데이터셋에서의 클래스 비율과 동일하다.
3. **독립성 가정**: 입력 변수들은 클래스 조건부 하에서 독립적이지 않으며, 공분산 행렬 \( \Sigma_k \)을 통해 변수 간의 상관관계를 모델링한다.

## GDA 모델 적합 과정

GDA 모델을 적합시키는 과정은 주로 다음과 같은 단계로 이루어집니다:

### 파라미터 추정

GDA 모델을 적합하기 위해서는 각 클래스의 평균 벡터 \( \mu_k \)와 공분산 행렬 \( \Sigma_k \), 그리고 클래스의 사전 확률 \( \phi_k = p(y = k) \)을 추정해야 합니다. 이는 최대 우도 추정(Maximum Likelihood Estimation, MLE)을 통해 수행됩니다.

#### 평균 벡터 추정

각 클래스 \( k \)에 대한 평균 벡터 \( \mu_k \)는 다음과 같이 추정됩니다:

$$
\mu_k = \frac{1}{N_k} \sum_{i=1}^{N} \mathbb{I}(y^{(i)} = k) \mathbf{x}^{(i)}
$$

여기서:
- \( N \)은 전체 데이터 포인트의 수,
- \( N_k \)는 클래스 \( k \)에 속하는 데이터 포인트의 수,
- \( \mathbb{I}(\cdot) \)는 지표 함수입니다.

#### 공분산 행렬 추정

각 클래스 \( k \)에 대한 공분산 행렬 \( \Sigma_k \)는 다음과 같이 추정됩니다:

$$
\Sigma_k = \frac{1}{N_k} \sum_{i=1}^{N} \mathbb{I}(y^{(i)} = k) (\mathbf{x}^{(i)} - \mu_k)(\mathbf{x}^{(i)} - \mu_k)^T
$$

#### 사전 확률 추정

각 클래스 \( k \)의 사전 확률 \( \phi_k \)는 다음과 같이 추정됩니다:

$$
\phi_k = \frac{N_k}{N}
$$

### 사후 확률 계산

모델이 적합된 후, 새로운 입력 데이터 \( \mathbf{x} \)에 대해 각 클래스에 속할 사후 확률 \( p(y = k|\mathbf{x}) \)을 계산합니다. 이는 베이즈 정리를 사용하여 다음과 같이 계산됩니다:

$$
p(y = k|\mathbf{x}) = \frac{p(\mathbf{x}|y = k) \, \phi_k}{\sum_{j=1}^{K} p(\mathbf{x}|y = j) \, \phi_j}
$$

여기서 \( K \)는 클래스의 수입니다.

## 의사결정 경계 설정

GDA에서는 의사결정 경계를 설정할 때, 사후 확률이 동일해지는 지점을 기준으로 분류를 수행합니다. 두 클래스 \( k = 1 \)과 \( k = 2 \)의 경우, 다음과 같은 조건에서 경계가 형성됩니다:

$$
p(y = 1|\mathbf{x}) = p(y = 2|\mathbf{x})
$$

이를 베이즈 정리에 대입하고, 다변량 정규 분포의 확률 밀도 함수를 사용하여 정리하면, 다음과 같은 이차 방정식 형태의 결정 경계를 얻게 됩니다:

$$
(\mathbf{x} - \mu_1)^T \Sigma_1^{-1} (\mathbf{x} - \mu_1) - (\mathbf{x} - \mu_2)^T \Sigma_2^{-1} (\mathbf{x} - \mu_2) + \ln \frac{|\Sigma_2|}{|\Sigma_1|} + 2 \ln \frac{\phi_2}{\phi_1} = 0
$$

만약 모든 클래스가 동일한 공분산 행렬 \( \Sigma \)을 공유한다면, 결정 경계는 선형 형태가 되며, 이 경우 GDA는 선형 판별 분석(Linear Discriminant Analysis, LDA)과 동일하게 동작합니다.

## 모델 평가

GDA 모델의 성능 평가는 주로 다음과 같은 지표를 사용하여 이루어집니다:

- **정확도(Accuracy)**: 전체 데이터 중 올바르게 분류된 비율.
- **정밀도(Precision)**: 양성으로 예측한 데이터 중 실제로 양성인 비율.
- **재현율(Recall)**: 실제 양성 데이터 중 올바르게 양성으로 예측한 비율.
- **F1 스코어(F1 Score)**: 정밀도와 재현율의 조화 평균.
- **ROC 곡선과 AUC 값**: 분류기의 임계값 변화에 따른 성능 평가.

모델의 복잡성과 오버피팅 여부를 판단하기 위해 교차 검증(cross-validation) 방법을 사용할 수도 있습니다.

## 장단점

### 장점

- **확률적 해석**: 사후 확률을 제공하여 불확실성 관리가 용이합니다.
- **효율성**: 파라미터 수가 비교적 적어 계산 효율성이 높습니다.
- **해석 용이성**: 모델의 파라미터를 통해 클래스의 분포를 직관적으로 이해할 수 있습니다.
- **다변량 확장성**: 고차원 데이터에도 효과적으로 적용될 수 있습니다.

### 단점

- **가우시안 가정**: 데이터가 실제로 다변량 정규 분포를 따르지 않을 경우 성능이 저하될 수 있습니다.
- **공분산 행렬 추정의 어려움**: 고차원 데이터에서 공분산 행렬을 정확히 추정하기 어려울 수 있습니다.
- **선형성 제한**: 공분산 행렬이 동일하지 않은 경우, 모델이 복잡해지고 과적합의 위험이 있습니다.

## 응용 사례

GDA는 다양한 분야에서 활용됩니다:

- **의료 진단**: 환자의 생체 신호나 의료 데이터를 기반으로 질병을 예측.
- **스팸 필터링**: 이메일의 특징을 분석하여 스팸 여부를 분류.
- **금융 사기 탐지**: 거래 패턴을 분석하여 사기 거래를 식별.
- **이미지 인식**: 이미지의 특징을 기반으로 객체를 분류.
- **음성 인식**: 음성 데이터의 특징을 바탕으로 발화자를 식별하거나 내용을 분류.

## 참고문헌

- Bishop, C. M. (2006). *Pattern Recognition and Machine Learning*. Springer.
- Murphy, K. P. (2022). *Probabilistic Machine Learning: An Introduction*. MIT Press.
- Murphy, K. P. (2023). *Probabilistic Machine Learning: Advanced Topics*. MIT Press.

# 요약

가우스 판별분석(GDA)은 클래스별로 다변량 정규 분포를 가정하여 분류 문제를 해결하는 지도 학습 알고리즘입니다. GDA 모델을 적합시키기 위해서는 각 클래스의 평균 벡터, 공분산 행렬, 그리고 사전 확률을 최대 우도 추정을 통해 추정해야 합니다. 모델이 적합된 후에는 사후 확률을 계산하여 새로운 입력 데이터의 클래스를 예측합니다. GDA는 확률적 해석과 높은 효율성을 제공하지만, 데이터가 정규 분포를 따르지 않을 경우 성능이 저하될 수 있다는 단점도 가지고 있습니다. 다양한 분야에서 활용될 수 있는 GDA는 특히 데이터의 통계적 특성을 이해하고자 할 때 유용한 도구입니다.